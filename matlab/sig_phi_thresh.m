%% Set 1% significance threshold for coherence in time-freqeuncy domain
%% according to sig_test_coh_table.m

function phic = sig_phi_thresh ( w0, nsig )

% load('threshold_phic_table.mat', 'p10')

x  = ceil(nsig-1); %table begins at nsig=2;
y  = ceil(w0-5); %table begins at w0=6
nl = 3; % noise level 3 leads to SNR=20*log10(1/3)=-10dB


p10(:,:,1) = ...
  [11.5000   10.5000    9.5000    9.5000    8.5000    8.5000    8.0000    7.5000    7.5000 7.5000;
    9.5000    8.5000    8.5000    7.5000    7.5000    6.5000    6.5000    6.5000    6.5000 6.0000;
    8.5000    7.5000    7.5000    6.5000    6.5000    6.5000    5.5000    5.5000    5.5000 5.5000;
    7.5000    6.5000    6.5000    6.0000    5.5000    5.5000    5.5000    4.5000    4.5000 4.5000;
    6.5000    6.5000    5.5000    5.5000    5.5000    4.5000    4.5000    4.5000    4.5000 4.5000;
    6.5000    5.5000    5.5000    5.0000    4.5000    4.5000    4.5000    4.5000    4.0000 3.5000;
    5.5000    5.5000    5.0000    4.5000    4.5000    4.5000    4.0000    3.5000    3.5000 3.5000;
    5.5000    5.5000    4.5000    4.5000    4.5000    3.5000    3.5000    3.5000    3.5000 3.5000;
    5.5000    4.5000    4.5000    4.5000    3.5000    3.5000    3.5000    3.5000    3.5000 3.5000];



p10(:,:,2) = ...
  [24.5000   22.5000   20.5000   19.5000   18.5000   17.5000   16.5000   16.5000   15.5000   14.5000;
   20.5000   18.5000   17.5000   16.5000   15.5000   14.5000   14.0000   13.5000   12.5000   12.5000;
   17.5000   16.5000   15.5000   14.5000   13.5000   12.5000   12.5000   11.5000   11.5000   10.5000;
   16.0000   14.5000   13.5000   12.5000   11.5000   11.5000   10.5000   10.5000   10.0000    9.5000;
   14.5000   13.5000   12.5000   11.5000   11.0000   10.5000    9.5000    9.5000    9.5000    9.0000;
   13.5000   12.5000   11.5000   10.5000   10.5000    9.5000    9.5000    8.5000    8.5000    8.5000;
   12.5000   11.5000   10.5000    9.5000    9.5000    9.0000    8.5000    8.5000    8.0000    7.5000;
   11.5000   10.5000    9.5000    9.5000    8.5000    8.5000    8.5000    7.5000    7.5000    7.5000;
   11.5000   10.5000    9.5000    9.0000    8.5000    8.0000    7.5000    7.5000    6.5000    6.5000];


p10(:,:,3) = ...
  [38.5000   35.5000   32.5000   30.5000   29.5000   27.5000   26.0000   25.5000   24.0000   23.5000;
   32.5000   29.5000   27.5000   25.5000   24.0000   22.5000   21.5000   20.5000   20.5000   19.5000;
   28.5000   25.5000   23.5000   22.5000   21.0000   20.5000   19.0000   18.5000   17.5000   16.5000;
   25.5000   23.5000   21.5000   20.5000   19.0000   17.5000   17.0000   16.5000   15.5000   15.0000;
   23.5000   21.5000   19.5000   18.5000   17.5000   16.5000   15.5000   15.0000   14.5000   14.0000;
   21.5000   19.5000   18.5000   17.0000   16.0000   15.5000   14.5000   13.5000   13.5000   12.5000;
   20.0000   18.5000   17.0000   15.5000   15.0000   14.5000   13.5000   13.0000   12.5000   12.0000;
   19.0000   17.5000   16.0000   15.0000   14.5000   13.5000   12.5000   12.5000   11.5000   11.5000;
   17.5000   16.5000   15.5000   14.0000   13.0000   12.5000   12.5000   11.5000   11.5000   10.5000];


p10(:,:,4) = ...
  [56.0000   51.0000   46.5000   43.5000   40.5000   38.5000   36.5000   34.5000   33.5000   32.0000;
   47.0000   42.5000   38.5000   36.0000   34.0000   32.5000   30.0000   28.5000   27.5000   26.5000;
   41.0000   37.0000   33.5000   31.5000   29.5000   28.0000   26.5000   25.5000   24.5000   23.5000;
   37.0000   33.5000   30.5000   28.5000   26.5000   25.0000   23.5000   22.5000   21.5000   21.0000;
   33.0000   30.0000   27.5000   25.5000   24.5000   23.0000   21.5000   21.0000   19.5000   19.0000;
   31.5000   28.0000   25.5000   23.5000   22.5000   21.0000   20.0000   19.0000   18.5000   17.5000;
   28.5000   26.0000   24.0000   22.5000   20.5000   19.5000   19.0000   17.5000   17.5000   16.5000;
   27.5000   24.5000   22.5000   21.5000   19.5000   19.0000   17.5000   16.5000   16.0000   15.5000;
   26.0000   23.5000   21.0000   20.0000   18.5000   18.5000   17.0000   16.5000   15.5000   14.5000];

p10(:,:,5) = ...
  [74.0000   68.0000   62.0000   57.5000   54.0000   51.0000   47.5000   45.5000   44.0000   42.0000;
   63.5000   57.5000   52.5000   49.0000   45.0000   42.5000   40.0000   38.0000   36.5000   35.5000;
   55.5000   50.5000   45.5000   42.0000   39.5000   37.5000   35.5000   33.0000   31.5000   30.5000;
   50.0000   44.5000   41.5000   38.0000   35.0000   33.0000   31.0000   29.5000   28.5000   27.5000;
   45.5000   41.5000   37.0000   34.5000   32.5000   30.5000   29.0000   27.5000   25.5000   25.0000;
   42.5000   37.5000   34.5000   31.5000   29.5000   28.5000   26.5000   25.0000   24.5000   23.5000;
   39.5000   35.0000   32.0000   30.0000   27.5000   26.0000   25.0000   23.5000   22.5000   21.5000;
   37.5000   33.5000   30.5000   28.5000   25.5000   24.5000   23.5000   22.0000   21.5000   20.5000;
   35.5000   31.5000   28.5000   26.5000   25.0000   23.5000   22.0000   21.0000   20.0000   19.5000];



phic = p10(x, y, nl);